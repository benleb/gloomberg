{{ define "title" }} gloomberg {{ end }} {{ define "view" }}

<main>
  <div class="stream" live-update="append" live-hook="eventstream">
    {{ range $event := .Assigns.Events }} {{ if .Divider }}
    <div class="divider"></div>
    {{ else }}

    <div id="{{.ID}}" class="message {{.EventType}}">
      <span class="time">{{.Time}}</span>
      <span class="typemoji">{{.Typemoji}}</span>

      {{ if .Msg }}
      <span>{{.ID}}:</span>
      <span>{{.Msg}}</span>
      {{ else }}

      <span class="pricearrow" style="color: {{.PriceArrowColor}};">→</span>

      <span class="price">{{.Price}}</span>
      <span class="currency" style="color: {{.ColorPrimary}};">Ξ</span>

      <span class="price" style="color: {{ .PricePerItemColor }};">{{.PricePerItem}}</span>
      <span class="per-item-currency" style="color: {{.ColorPrimary }};">Ξ</span>

      <span class="trendindicator" style="color: #282828;">~</span>
      {{/* <span class="trendindicator" style="color: {{ .TrendIndicatorColor }};">{{.TrendIndicator}}</span> */}}
      <span class="floor-price">{{.FloorPrice}}</span>
      <span class="floor-price-currency" style="color: {{.ColorPrimary }};">Ξ</span>

      {{ if gt .NumItems 1 }}
      <span class="collection" style="color: {{.NumItemsColor}};">{{.NumItems}}x</span>
      {{- end }}

      <span class="collection" style="color: {{.ColorPrimary}};">{{.CollectionName}}</span>
      <span class="hashtag" style="color: {{.ColorSecondary}};">#</span>
      <span class="tokenid" style="color: {{.ColorPrimary}};">{{.TokenID}}</span>

      <span class="divider">|</span>
      <a class="opensea" href="{{.LinkOpenSea}}" target="_blank">OS</a>

      <span class="divider">|</span>
      <a class="etherscan" href="{{.LinkEtherscan}}" target="_blank">ES</a>

      <span class="divider">|</span><span class="divider">→</span>
      <span class="to" style="color: {{.ToColor}};">{{.To}}</span>

      {{ if gt .SaLiRa 0.0 }}
      <span class="divider">|</span>
      <span>{{ printf "%4.2f" .SaLiRa }}</span>
      {{- end }} {{- end }}
    </div>

    {{- end }} {{ end }}
  </div>

  <div class="commandline">
    <form id="commandline" live-submit="send" live-hook="input">
      <input autocomplete="off" type="text" name="message" autofocus />
      <button type="submit" disabled>go</button>
    </form>
  </div>

  <div class="side-header"></div>

  <div class="side-trending"></div>

  <div class="side-wallets"></div>

  <div class="side-footer"></div>
</main>

<script>
  window.Hooks = {
    input: {
      mounted: function () {
        // clear text field
        this.el.addEventListener("submit", () => {
          this.el.querySelector("input").value = "";
        });
      },
    },
    eventstream: {
      // auto-scroll to bottom
      updated: function () {
        this.el.scrollTop = this.el.scrollHeight;
      },
    },
  };
</script>

{{ end }}
